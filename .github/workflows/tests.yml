name: Run KraftKollen.Tests on Pull Request

on:
  workflow_dispatch:
  pull_request:
    branches:
      -  main

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      -  name: Checkout code
         uses: actions/checkout@v4
          
      -  name: Setup .NET
         uses: actions/setup-dotnet@v4
         with:
            dotnet-version: '8.0' # Specify the version you're using, adjust as necessary
            
      - name: Set locale to support UTF-8
        run: |
          sudo apt-get update
          sudo apt-get install -y locales
          sudo locale-gen sv_SE.UTF-8
          export LANG=sv_SE.UTF-8
          export LC_ALL=sv_SE.UTF-8
          
      -  name: Restore dependencies
         run: cd KraftKollen; dotnet restore
            
      -  name: Run tests
         run: cd KraftKollen; dotnet test KraftKollen.Tests/KraftKollen.Tests.csproj --no-restore --verbosity normal
         env:
           DOTNET_SYSTEM_GLOBALIZATION_INVARIANT: false # Ensures .NET uses the system's globalization settings
