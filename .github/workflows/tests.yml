name: Run KraftKollen.Tests on Pull Request

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      -  name: Checkout code
         uses: actions/checkout@v4
          
      -  name: Setup .NET
         uses: actions/setup-dotnet@v4
         with:
            dotnet-version: '8.0' # Specify the version you're using, adjust as necessary
            
      -  name: Restore dependencies
         run: cd KraftKollen; dotnet restore

      - name: Install and configure locale
        run: |
          sudo apt-get update
          sudo apt-get install -y locales
          sudo locale-gen sv_SE.UTF-8
          echo "LANG=sv_SE.UTF-8" | sudo tee /etc/default/locale
          export LANG=sv_SE.UTF-8
          export LC_ALL=sv_SE.UTF-8
          locale
          
      - name: Generate Swedish locale
        run: |
          sudo locale-gen sv_SE.UTF-8
          sudo update-locale LANG=sv_SE.UTF-8 LC_ALL=sv_SE.UTF-8
          locale
            
      -  name: Run tests
         env:
           DOTNET_SYSTEM_GLOBALIZATION_INVARIANT: false
           LANG: sv_SE.UTF-8
           LC_ALL: sv_SE.UTF-8
         run: cd KraftKollen; dotnet test KraftKollen.Tests/KraftKollen.Tests.csproj --no-restore --verbosity normal


